{% extends "base.html" %}

{% block lab %}Лабораторная работа 5{% endblock %}

{% block main %}
    <h1>Статьи</h1>

    {% if message %}
        <p>{{ message }}</p>
    {% endif %}
    
    {% for article in articles %}
        <div class="article-card" style="border:1px solid #ddd;padding:12px;border-radius:8px;margin-bottom:12px;background:#fafafa;">
            <h2>
                {{ article['title'] }}
                {% if article.get('is_favorite') in [1, '1', True] or article.get('is_favorite') == True %}
                    <sup>★</sup>
                {% endif %}
            </h2>
            <div style="font-size:0.9em;color:#666;margin-bottom:8px;">
                Автор: {{ article['author_name'] or article['author_login'] }} ({{ article['author_login'] }})
                {% if article.get('is_public') in [1, '1', True] or article.get('is_public') == True %}
                    • публичная
                {% else %}
                    • приватная
                {% endif %}
            </div>
            <blockquote style="margin:0 0 8px 0;">{{ article['article_text'] }}</blockquote>

            {% if login == article['author_login'] %}
                <div style="display:flex; gap:8px;">
                    <a href="/lab5/article/{{ article['id'] }}/edit">Редактировать</a>
                    <form action="/lab5/article/{{ article['id'] }}/delete" method="post" style="display:inline;">
                        <button type="submit" onclick="return confirm('Удалить статью?')">Удалить</button>
                    </form>
                </div>
            {% endif %}
        </div>
    {% endfor %}
{% endblock %}


